<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>正規分布デモ（軸固定）</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    body { font-family: sans-serif; max-width: 800px; margin: 20px auto; }
    .control { margin-bottom: 20px; }
    label { display: block; margin-bottom: 8px; }
  </style>
</head>
<body>
  <h1>正規分布（μ と σ を変えても軸は固定）</h1>

  <div class="control">
    <label>
      μ（平均）: <span id="mu-value">0</span>
      <input id="mu" type="range" min="-3" max="3" step="0.1" value="0">
    </label>
    <label>
      σ（標準偏差）: <span id="sigma-value">1</span>
      <input id="sigma" type="range" min="0.5" max="3" step="0.1" value="1">
    </label>
  </div>

  <div id="plot" style="width:100%;height:400px;"></div>

  <script>
    // 正規分布の密度関数
    function normalPdf(x, mu, sigma) {
      const coeff = 1 / (sigma * Math.sqrt(2 * Math.PI));
      const exponent = - Math.pow(x - mu, 2) / (2 * sigma * sigma);
      return coeff * Math.exp(exponent);
    }

    // x は固定の範囲 [-10, 10] で生成
    function generateXs() {
      const xs = [];
      const start = -10;
      const end = 10;
      const step = (end - start) / 400;
      for (let x = start; x <= end; x += step) {
        xs.push(x);
      }
      return xs;
    }

    const xs = generateXs();

    // 与えられた μ, σ で y を計算
    function computeYs(mu, sigma) {
      return xs.map(x => normalPdf(x, mu, sigma));
    }

    const muInput = document.getElementById('mu');
    const sigmaInput = document.getElementById('sigma');
    const muValue = document.getElementById('mu-value');
    const sigmaValue = document.getElementById('sigma-value');

    // 初期パラメータ
    let mu = parseFloat(muInput.value);
    let sigma = parseFloat(sigmaInput.value);

    // 初期描画
    muValue.textContent = mu.toFixed(1);
    sigmaValue.textContent = sigma.toFixed(1);

    const trace = {
      x: xs,
      y: computeYs(mu, sigma),
      mode: 'lines',
      name: 'Normal PDF'
    };

    const layout = {
      margin: { t: 20 },
      xaxis: {
        title: 'x',
        range: [-10, 10],     // x 軸を固定
        autorange: false
      },
      yaxis: {
        title: 'f(x)',
        range: [0, 0.5],      // y 軸も固定（必要に応じて調整）
        autorange: false
      }
    };

    Plotly.newPlot('plot', [trace], layout, {responsive: true});

    // スライダー変更時に形だけ更新
    function updatePlot() {
      mu = parseFloat(muInput.value);
      sigma = parseFloat(sigmaInput.value);
      muValue.textContent = mu.toFixed(1);
      sigmaValue.textContent = sigma.toFixed(1);

      const ys = computeYs(mu, sigma);

      // y だけ更新（軸はそのまま）
      Plotly.restyle('plot', { y: [ys] });
    }

    muInput.addEventListener('input', updatePlot);
    sigmaInput.addEventListener('input', updatePlot);
  </script>
</body>
</html>
